---
layout: post
title: SQL Joins Made Simple
date: 2019-08-01 00:00:00 +0100
description: # Add post description (optional)
img: 2019-08-01-main_pic.jpg # Add image post (optional)
fig-caption: # Add figcaption (optional)
tags: [SQL]
---

**_This tutorial is based on Oracle SQL._**

# INNER JOIN with common key column name

To begin let's create two ultra-simple tables:

```sql
CREATE TABLE left_table
  (
     id  NUMBER(10) NOT NULL,
     left_val VARCHAR2(50),
     CONSTRAINT left_table_pk PRIMARY KEY (id)
  );

INSERT INTO left_table VALUES (1, 'LEFT 1');

INSERT INTO left_table VALUES (2, 'LEFT 2');

INSERT INTO left_table VALUES (3, 'LEFT 3');

INSERT INTO left_table VALUES (4, 'LEFT 4');

SELECT *
FROM   left_table;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">2</td>
    <td class="tg-au0w">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
  </tr>
</table>
<br>
```sql
CREATE TABLE right_table
  (
     id  NUMBER(10) NOT NULL,
     right_val VARCHAR2(50),
     CONSTRAINT right_table_pk PRIMARY KEY (id)
  );

INSERT INTO right_table VALUES (1, 'RIGHT 1');

INSERT INTO right_table VALUES (4, 'RIGHT 4');  

INSERT INTO right_table VALUES (5, 'RIGHT 5');

INSERT INTO right_table VALUES (6, 'RIGHT 6');

SELECT *
FROM   right_table;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">ID</th>
    <th class="tg-ag0r">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
  </tr>
</table>

In our example **ID** columns in both tables are **key fields** since they can be used to reference one table to another. To perform an **INNER JOIN** (sometimes called **simple join**) we look for key matches in the right table corresponding to all key field entries of the left table. Here only values 1 and 4 are common for both tables. The **INNER JOIN** query and its result will then be:

```sql
SELECT *
FROM   left_table l
       INNER JOIN right_table r
               ON l.id = r.id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">ID</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">RIGHT 4</td>
  </tr>
</table>

Note the use of aliases **l** and **r** which reduce the amount of typing and make the query easier to read. Also you probably noticed that there is duplicated **ID** column. We can call specific columns in the **SELECT** statement:

```sql
SELECT l.id,
       left_val,
       right_val
FROM   left_table l
       INNER JOIN right_table r
               ON l.id = r.id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 75%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">LEFT 4</td>
    <td class="tg-au0w">RIGHT 4</td>
  </tr>
</table>

Since the key column name is the same in both tables, the same join can be performed with **USING** keyword:

```sql
SELECT *
FROM   left_table l
       INNER JOIN right_table r
USING (id);
```

# INNER JOIN with different key column names

Let's create nearly identical tables as before, only this time instead of naming key columns **ID** in both tables, we will name them **LEFT_ID** and **RIGHT_ID**. Note that if you created tables for the previous example, you will need to drop them first.

```sql
DROP TABLE left_table;

CREATE TABLE left_table
  (
     left_id  NUMBER(10) NOT NULL,
     left_val VARCHAR2(50),
     CONSTRAINT left_table_pk PRIMARY KEY (left_id)
  );

INSERT INTO left_table VALUES (1, 'LEFT 1');

INSERT INTO left_table VALUES (2, 'LEFT 2');

INSERT INTO left_table VALUES (3, 'LEFT 3');

INSERT INTO left_table VALUES (4, 'LEFT 4');

SELECT *
FROM   left_table;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">2</td>
    <td class="tg-au0w">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
  </tr>
</table>
<br>
```sql
DROP TABLE right_table;

CREATE TABLE right_table
  (
     right_id  NUMBER(10) NOT NULL,
     right_val VARCHAR2(50),
     CONSTRAINT right_table_pk PRIMARY KEY (right_id)
  );

INSERT INTO right_table VALUES (1, 'RIGHT 1');

INSERT INTO right_table VALUES (4, 'RIGHT 4');

INSERT INTO right_table VALUES (5, 'RIGHT 5');

INSERT INTO right_table VALUES (6, 'RIGHT 6');

SELECT *
FROM   right_table;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">RIGHT_ID</th>
    <th class="tg-ag0r">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
  </tr>
</table>

The inner join query is then constructed as follows:

```sql
SELECT *
FROM   left_table l
       INNER JOIN right_table r
               ON l.left_id = r.right_id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">RIGHT_ID</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">RIGHT 4</td>
  </tr>
</table>


Again, we could select specific columns within **SELECT** statement if we didn't want to see duplicate values. We can also perform **INNER JOIN** with more than two tables. Let's now create a third table:

```sql
CREATE TABLE another_table
  (
     another_id  NUMBER(10) NOT NULL,
     another_val VARCHAR2(50),
     CONSTRAINT another_table_pk PRIMARY KEY (another_id)
  );

INSERT INTO another_table VALUES (1, 'ANOTHER 1');

INSERT INTO another_table VALUES (3, 'ANOTHER 3');

INSERT INTO another_table VALUES (5, 'ANOTHER 5');

INSERT INTO another_table VALUES (7, 'ANOTHER 7');

SELECT *
FROM   another_table;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">ANOTHER_ID</th>
    <th class="tg-ag0r">ANOTHER_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">ANOTHER 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">3</td>
    <td class="tg-au0w">ANOTHER 3</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">ANOTHER 5</td>
  </tr>
  <tr>
    <td class="tg-ggkl">7</td>
    <td class="tg-ggkl">ANOTHER 7</td>
  </tr>
</table>


Only ID value = 1 is common for all three tables so this will be the only record preserved after joining all of them:

```sql
SELECT left_id,
       left_val,
       right_val,
       another_val
FROM   left_table l
       INNER JOIN right_table r
               ON l.left_id = r.right_id
       INNER JOIN another_table a
               ON l.left_id = a.another_id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
    <th class="tg-gvb5">ANOTHER_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">RIGHT 1</td>
    <td class="tg-au0w">ANOTHER 1</td>
  </tr>
</table>


# SELF JOIN

Let's create a little bit different table to see how joining table with itself might be useful.

```sql
CREATE TABLE company
  (
     employee_id   NUMBER(3),
     employee_name VARCHAR(50),
     manager_id    NUMBER(3)
  );

INSERT INTO company
VALUES      (200, 'Mark', NULL);

INSERT INTO company
VALUES      (205, 'Fred', 200);

INSERT INTO company
VALUES      (207, 'Peter', 200);

INSERT INTO company
VALUES      (210, 'Anna', 207);

SELECT *
FROM   company;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-fk1o{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 75%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">EMPLOYEE_ID</th>
    <th class="tg-ag0r">EMPLOYEE_NAME</th>
    <th class="tg-fk1o">MANAGER_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">200</td>
    <td class="tg-x4o0">Mark</td>
    <td class="tg-ggkl"> - </td>
  </tr>
  <tr>
    <td class="tg-x4o0">205</td>
    <td class="tg-x4o0">Fred</td>
    <td class="tg-ggkl">200</td>
  </tr>
  <tr>
    <td class="tg-x4o0">207</td>
    <td class="tg-x4o0">Peter</td>
    <td class="tg-ggkl">200</td>
  </tr>
  <tr>
    <td class="tg-x4o0">210</td>
    <td class="tg-x4o0">Anna</td>
    <td class="tg-ggkl">207</td>
  </tr>
</table>

Self join is performed just like inner join, except now we join the table with itself. The name of the table appears twice in the query, hence it has to be followed by aliases. We could perform a self join on the **company** table to see not only IDs of employees' managers, but managers' names as well:

```sql
SELECT c1.employee_id,
       c1.employee_name,
       c1.manager_id,
       c2.employee_name AS manager_name
FROM   company c1
       INNER JOIN company c2
               ON c1.manager_id = c2.employee_id;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-fk1o{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">EMPLOYEE_ID</th>
    <th class="tg-ag0r">EMPLOYEE_NAME</th>
    <th class="tg-fk1o">MANAGER_ID</th>
    <th class="tg-fk1o">MANAGER_NAME</th>
  </tr>
  <tr>
    <td class="tg-x4o0">205</td>
    <td class="tg-x4o0">Fred</td>
    <td class="tg-ggkl">200</td>
    <td class="tg-ggkl">Mark</td>
  </tr>
  <tr>
    <td class="tg-x4o0">207</td>
    <td class="tg-x4o0">Peter</td>
    <td class="tg-ggkl">200</td>
    <td class="tg-ggkl">Mark</td>
  </tr>
  <tr>
    <td class="tg-x4o0">210</td>
    <td class="tg-x4o0">Anna</td>
    <td class="tg-ggkl">207</td>
    <td class="tg-ggkl">Peter</td>
  </tr>
</table>


# LEFT JOIN & RIGHT JOIN

In **LEFT JOIN** all original records from the left table are preserved, even those that do not have matches in the right table. The syntax is similar to the syntax of inner join.

```sql
SELECT *
FROM   left_table l
       LEFT JOIN right_table r
              ON l.left_id = r.right_id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">RIGHT_ID</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
    <td class="tg-x4o0">LEFT 4</td>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
  </tr>
  <tr>
    <td class="tg-x4o0">2</td>
    <td class="tg-x4o0">LEFT 2</td>
    <td class="tg-au0w"> - </td>
    <td class="tg-au0w"> - </td>
  </tr>
  <tr>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl"> - </td>
  </tr>
</table>

Analogically, in **RIGHT JOIN** all original records from right table are preserved, even those that do not have matches in the left table. Right joins are generally less often used.

```sql
SELECT *
FROM   left_table l
       RIGHT JOIN right_table r
               ON l.left_id = r.right_id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">RIGHT_ID</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
    <td class="tg-x4o0">LEFT 4</td>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
  </tr>
  <tr>
    <td class="tg-x4o0"> - </td>
    <td class="tg-x4o0"> - </td>
    <td class="tg-au0w">6</td>
    <td class="tg-au0w">RIGHT 6</td>
  </tr>
  <tr>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
  </tr>
</table>

# FULL OUTER JOIN

**FULL OUTER JOIN** is a combination of left join and right join. It returns all records from both tables whether they have matches in the other table or not.

```sql
SELECT *
FROM   left_table l
       FULL OUTER JOIN right_table r
                    ON l.left_id = r.right_id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
    <th class="tg-ag0r">LEFT_VAL</th>
    <th class="tg-gvb5">RIGHT_ID</th>
    <th class="tg-gvb5">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">LEFT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">RIGHT 1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
    <td class="tg-x4o0">LEFT 4</td>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
  </tr>
  <tr>
    <td class="tg-x4o0"> - </td>
    <td class="tg-x4o0"> - </td>
    <td class="tg-au0w">5</td>
    <td class="tg-au0w">RIGHT 5</td>
  </tr>
  <tr>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
  </tr>
  <tr>
    <td class="tg-ggkl">2</td>
    <td class="tg-ggkl">LEFT 2</td>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl"> - </td>
  </tr>
  <tr>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
    <td class="tg-ggkl"> - </td>
    <td class="tg-ggkl"> - </td>
  </tr>
</table>

Note that the order of tables in a query matters. If we switch their order, the output is slightly different.

```sql
SELECT *
FROM   right_table r
       FULL OUTER JOIN left_table l
                    ON l.left_id = r.right_id
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">RIGHT_ID</th>
    <th class="tg-ag0r">RIGHT_VAL</th>
    <th class="tg-gvb5">LEFT_ID</th>
    <th class="tg-gvb5">LEFT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">RIGHT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-x4o0"> - </td>
    <td class="tg-x4o0"> - </td>
    <td class="tg-au0w">2</td>
    <td class="tg-au0w">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-x4o0"> - </td>
    <td class="tg-x4o0"> - </td>
    <td class="tg-au0w">3</td>
    <td class="tg-au0w">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">LEFT 4</td>
  </tr>
  <tr>
    <td class="tg-au0w">6</td>
    <td class="tg-au0w">RIGHT 6</td>
    <td class="tg-au0w"> - </td>
    <td class="tg-au0w"> - </td>
  </tr>
  <tr>
    <td class="tg-au0w">5</td>
    <td class="tg-au0w">RIGHT 5</td>
    <td class="tg-au0w"> - </td>
    <td class="tg-au0w"> - </td>
  </tr>
</table>

# CROSS JOIN

**CROSS JOIN** creates a combination of all rows from the right table with all rows from the left table. If there are **x** rows in one of the tables and **y** rows in the other, the resulting table will have **x\*y** rows. In other words, if two tables are joined with cross join with no condition, the query returns their **Cartesian product**.

```sql
SELECT *
FROM   right_table
       CROSS JOIN left_table
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-gvb5{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 100%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">RIGHT_ID</th>
    <th class="tg-ag0r">RIGHT_VAL</th>
    <th class="tg-gvb5">LEFT_ID</th>
    <th class="tg-gvb5">LEFT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">RIGHT 1</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">RIGHT 1</td>
    <td class="tg-au0w">2</td>
    <td class="tg-au0w">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-x4o0">RIGHT 1</td>
    <td class="tg-au0w">3</td>
    <td class="tg-au0w">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">RIGHT 1</td>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">LEFT 4</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
    <td class="tg-au0w">1</td>
    <td class="tg-au0w">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
    <td class="tg-au0w">RIGHT 4</td>
    <td class="tg-au0w">2</td>
    <td class="tg-au0w">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">RIGHT 4</td>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">RIGHT 4</td>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
    <td class="tg-ggkl">1</td>
    <td class="tg-ggkl">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
    <td class="tg-ggkl">2</td>
    <td class="tg-ggkl">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
    <td class="tg-ggkl">1</td>
    <td class="tg-ggkl">LEFT 1</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
    <td class="tg-ggkl">2</td>
    <td class="tg-ggkl">LEFT 2</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
    <td class="tg-ggkl">3</td>
    <td class="tg-ggkl">LEFT 3</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
    <td class="tg-ggkl">4</td>
    <td class="tg-ggkl">LEFT 4</td>
  </tr>
</table>


# VENN DIAGRAMS & SET OPERATIONS

**Venn diagrams** are used to show all possible logical relations between a collection of different sets. Each circle in the diagram represents a table of data. The shading shows what is included in the result of a particular set operation:

**UNION** includes all records from both tables. Records that appear in both tables are shown only once in the result (in other words it returns only **distinct values**).

<img src="\assets\img\2019-08-01-sql_joins\union.png" width="20%"/>

```sql
SELECT left_id
FROM   left_table
UNION
SELECT right_id
FROM   right_table
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 25%">
<colgroup>
<col style="width: 25px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">2</td>
  </tr>
  <tr>
    <td class="tg-x4o0">3</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
  </tr>
  <tr>
    <td class="tg-au0w">5</td>
  </tr>
  <tr>
    <td class="tg-au0w">6</td>
  </tr>
</table>


**UNION ALL** also includes all records from both tables. However this time, records that appear in both tables will be shown twice in the result (they will be **duplicated**).

<img src="\assets\img\2019-08-01-sql_joins\union_all.png" width="20%"/>

```sql
SELECT left_id
FROM   left_table
UNION ALL
SELECT right_id
FROM   right_table
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-au0w{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 25%">
<colgroup>
<col style="width: 25px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">2</td>
  </tr>
  <tr>
    <td class="tg-x4o0">3</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
  </tr>
  <tr>
    <td class="tg-au0w">1</td>
  </tr>
  <tr>
    <td class="tg-au0w">4</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
  </tr>
</table>

**INTERSECT** includes only those records that are found in both tables.

<img src="\assets\img\2019-08-01-sql_joins\intersect.png" width="20%"/>

```sql
SELECT left_id
FROM   left_table
INTERSECT
SELECT right_id
FROM   right_table
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 25%">
<colgroup>
<col style="width: 25px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
  </tr>
</table>


**MINUS** includes all the records from one table that are not found in the other (_in some other SQL DB versions, like SQL Server, PostgreSQL or SQLite, the equivalent for MINUS keyword is **EXCEPT**_).

<img src="\assets\img\2019-08-01-sql_joins\except.png" width="20%"/>

```sql
SELECT left_id
FROM   left_table
MINUS
SELECT right_id
FROM   right_table
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 25%">
<colgroup>
<col style="width: 25px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">2</td>
  </tr>
  <tr>
    <td class="tg-x4o0">3</td>
  </tr>
</table>

It's important that the fields included in all above operations are of the same data type since they appear on top of one another in the result.

***

# SEMI-JOINS & ANTI-JOINS

The **SEMI-JOIN** chooses all records from the first table that satisfy the condition which is based on the second table.

```sql
SELECT left_id
FROM   left_table
WHERE  left_id IN (SELECT right_id
                   FROM   right_table)
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 25%">
<colgroup>
<col style="width: 25px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
  </tr>
</table>

The **ANTI-JOIN** chooses all records from the first that **do not** satisfy the condition which is based on the second table.

```sql
SELECT left_id
FROM   left_table
WHERE  left_id NOT IN (SELECT right_id
                   FROM   right_table)
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 25%">
<colgroup>
<col style="width: 25px">
</colgroup>
  <tr>
    <th class="tg-ag0r">LEFT_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">2</td>
  </tr>
  <tr>
    <td class="tg-x4o0">3</td>
  </tr>
</table>

These types of joins do not have their own special syntax like inner or outer joins have. They are rather a way of filtering rows of one table using rows of another table.

***

# SUBQUERIES (NESTED QUERIES)

A subquery in SQL is a query embedded within another query. It may appear inside **WHERE** (most common), **SELECT** or **FROM** clause.


## SUBQUERIES INSIDE WHERE CLAUSE

Subqueries (**inner queries** or **inner selects**) do not have any type of special syntax, they are simply regular queries placed inside parentheses somewhere in a larger query (**outer query** or **outer select**). The inner query is executed first and its result is then passed to the parent query. We can use any kind of comparison operators such as >, < or = to compare this result with some other expression.  

```sql
SELECT *
FROM   right_table
WHERE  right_id > (SELECT MAX(left_id)
                   FROM   left_table)
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-gdgg{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">RIGHT_ID</th>
    <th class="tg-gdgg">RIGHT_VAL</th>
  </tr>
  <tr>
    <td class="tg-x4o0">5</td>
    <td class="tg-ggkl">RIGHT 5</td>
  </tr>
  <tr>
    <td class="tg-x4o0">6</td>
    <td class="tg-ggkl">RIGHT 6</td>
  </tr>
</table>

Above query results in all records from the right table which id is greater than the maximum id from the left table.

## SUBQUERIES INSIDE SELECT CLAUSE

```sql
SELECT DISTINCT right_id,
                (SELECT COUNT(*)
                 FROM   left_table
                 WHERE  left_table.left_id = right_table.right_id) AS
                left_id_count
FROM right_table  
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-gdgg{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">RIGHT_ID</th>
    <th class="tg-gdgg">LEFT_ID_COUNT</th>
  </tr>
  <tr>
    <td class="tg-x4o0">1</td>
    <td class="tg-ggkl">1</td>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
    <td class="tg-ggkl">1</td>
  </tr>
  <tr>
    <td class="tg-ggkl">5</td>
    <td class="tg-ggkl">0</td>
  </tr>
  <tr>
    <td class="tg-ggkl">6</td>
    <td class="tg-ggkl">0</td>
  </tr>
</table>


Above query may seem a little bit complicated at the first glance. What it does is it takes all id values from the right table and counts how many times they appear in the left table.

## SUBQUERIES INSIDE FROM CLAUSE

```sql
SELECT right_table.right_id,
       subquery1.left_max_id
FROM   right_table,
       (SELECT MAX(left_id) AS left_max_id
        FROM   left_table) subquery1
WHERE  subquery1.left_max_id = right_table.right_id;
```
Output:
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-ag0r{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;border-color:inherit;text-align:left;vertical-align:middle}
.tg .tg-ggkl{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;text-align:left;vertical-align:top}
.tg .tg-gdgg{font-weight:bold;font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;background-color:#efefef;color:#000000;text-align:left;vertical-align:top}
.tg .tg-x4o0{font-size:12px;font-family:Verdana, Geneva, sans-serif !important;;border-color:inherit;text-align:left;vertical-align:middle}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 50%">
<colgroup>
<col style="width: 100px">
<col style="width: 100px">
</colgroup>
  <tr>
    <th class="tg-ag0r">RIGHT_ID</th>
    <th class="tg-gdgg">LEFT_MAX_ID</th>
  </tr>
  <tr>
    <td class="tg-x4o0">4</td>
    <td class="tg-ggkl">4</td>
  </tr>
</table>

The above query basically checks if maximum id from left table can be found within id values of right table.

***

To sum up, there are six types of SQL joins: **INNER JOIN** with its special case **SELF JOIN**, three outer joins (**LEFT JOIN**, **RIGHT JOIN** and **FULL OUTER JOIN**) and **CROSS JOIN**. Data can also be joined using set operations: **UNION**, **UNION ALL**, **INTERSECT** and **EXCEPT**. Finally, we can use **SUBQUERIES** for semi-joins and anti-joins. Subqueries may occur in three places within outer query: in WHERE, SELECT of FROM clause.

_Hope you enjoyed this article! In case of any questions and remarks, please leave a comment._
